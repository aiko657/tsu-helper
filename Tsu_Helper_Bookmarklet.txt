javascript:(function(){function e(e){var t,n,o,r,i,a,s,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="",f=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");f<e.length;)r=c.indexOf(e.charAt(f++)),i=c.indexOf(e.charAt(f++)),a=c.indexOf(e.charAt(f++)),s=c.indexOf(e.charAt(f++)),t=r<<2|i>>4,n=(15&i)<<4|a>>2,o=(3&a)<<6|s,l+=String.fromCharCode(t),64!=a&&(l+=String.fromCharCode(n)),64!=s&&(l+=String.fromCharCode(o));return l}function t(e){var t=e.split("#").length-1;l(t+" Hashtags found.");var n=e.split("@").length-1;if(l(n+" Mentions found."),h>=t&&p>=n)return null;var o="Limits exceeded, check your message! Are you sure you want to continue?\n";return t>h&&(o+="\n"+t+" #hashtags found. (Max. "+h+")",l("Too many hashtags found! ("+t+")","w")),n>p&&(o+="\n"+n+" @mentions found. (Max. "+p+")",l("Too many mentions found! ("+n+")","w")),confirm(o)}function n(e){var t=null,n=null;if(e.find(".checkboxes_options_create_post input:visible").each(function(){switch($(this).attr("id")){case"facebook":t=$(this).prop("checked");break;case"twitter":n=$(this).prop("checked")}}),!1!==t&&!1!==n)return null;var o="OK = Post to Tsu";return!0===t&&(o+=", Facebook"),!0===n&&(o+=", Twitter"),confirm(o+"\nCancel = Choose other social networks")}function o(e,o){var r=e.find("#message"),i=r.val();r.focus(),(""==i||!1===t(i)||!1===n(e))&&(o.preventDefault(),e.find(".loading").hide(),setTimeout(function(){e.find("#create_post_button").removeAttr("disabled")},500))}function r(){var e=$(".fancybox-overlay #create_post_form");return e.length?(e.find("#message").focus(),e.submit(function(e){return o($(this),e)}),void(_=!1)):void setTimeout(function(){r()},500)}function i(){F=!1,O=!1;for(var e in x)x[e].abort(),delete x[e];A.abort(),C.hide(),T.show()}function a(e,t){if(!t||O){l("Getting page "+e);var n="/users/profiles/users_list/"+window.current_user.id+"/"+k+"/"+e,o=$.get(n,function(n){var o=$(n).siblings(".card");o.length&&(o.each(function(){$(this).find(".friend_request_box").length&&$(".profiles_list .card:not(.tsu-helper-card):first").before($(this).addClass("tsu-helper-card"))}),t&&($(n).siblings(".loadmore_profile").length?a(e+1,!0):(l("Chain completed at page "+e),O=!1)))}).fail(function(t,n,o){l("abort"==n?"Abort page "+e:"Error on page "+e+"! ("+n+":"+o+")")}).always(function(){l("Finished page "+e),t||delete x[e],s()});t?A=o:x[e]=o}}function s(){var e=Object.keys(x).length;l("Checking... "+e+" left."),O||0!=e||i()}function c(){F=!0,O=!0,$(".tsu-helper-card").remove();for(var e=y;e>=1;e--)a(e,e==y);T.hide(),C.show()}function l(e,t,n){if(d){switch(t){case"i":console.info(e);break;case"w":console.warn(e);break;case"e":console.error(e);break;default:console.log(e)}n&&alert(e)}}function f(){l("Added CSS."),$("<style>").html("        #tsu-helper-menuitem-update a:before {          display: none !important;        }        #ffr-link-find, #ffr-link-cancel {          float: right;        }        .tsu-helper-card {          background: #cfc;        }      ").appendTo("head")}function u(){$.getJSON(v,function(t){var n=parseFloat(e(t.content));if(l("Versions: Local ("+b+"), Remote ("+n+")","i"),n>b&&($("#navBarHead .tab.name").css("background-color","#F1B054"),0===$("#tsu-helper-menuitem-update").length)){var o=$("<a/>",{title:"Update Tsu Helper script to the newest version ("+n+")",href:g,html:"Update Tsu Helper!"}).attr("target","_blank").css({"background-color":"#F1B054",color:"#fff"}).click(function(){return confirm("Upgrade to the newest version ("+n+")?\n\n(refresh this page after the script has been updated)")?void 0:!1});$("<li/>",{id:"tsu-helper-menuitem-update",html:o}).appendTo("#navBarHead .sub_nav")}}).fail(function(){l("Couldn't get remote version number for Tsu Helper.","w")})}f();var d=!1,h=10,p=10,m=12,g="https://greasyfork.org/scripts/6372-tsu-helper/code/Tsu%20Helper.user.js",b=1.1,v="https://api.github.com/repos/noplanman/tsu-helper/contents/VERSION";u(),$("#message, #message_body").focus(),$("body").on("click",".create_post .options .add_title",function(){var e=$(this).closest("#create_post_form").find("#title");setTimeout(function(){e.focus()},50)}),$("body").on("click",".create_post .options .filebutton, .cancel_icon_createpost",function(){var e=$(this).closest("#create_post_form").find("#message");setTimeout(function(){e.focus()},50)}),$("#create_post_form").submit(function(e){return o($(this),e)});var _=!1;if($(".create_post_popup").click(function(){_||(_=!0,r())}),$("body").on("dblclick",".post_header_name, .share_header",function(e){var t=$(this).closest(".post"),n=t.find(".share_header").length,o=!$(this).hasClass("share_header");t.find("#post_link_dropdown a").each(function(){var t=$(this).text().trim().toLowerCase();if(!n&&"open"===t||!o&&"open"===t||o&&"open original post"===t){var r=$(this).attr("href");return void(e.shiftKey?window.open(r,"_blank").focus():window.location=r)}})}),window.current_user.username==$(".profile_details .summary .username").text().trim().substring(1)){var k=null;if($("body.profile.following").length&&(k="following"),$("body.profile.followers").length&&(k="followers"),l("Current page: "+k),k){var w=$(".profiles_list .title"),y=Math.ceil(/\d+/.exec(w.text())/m);l("Total number of pages to load: "+y);var C=$("<a/>",{title:"Cancel current search",html:'<img class="tff-loader-wheel" src="/assets/loader.gif" /> Cancel',id:"ffr-link-cancel"}).click(function(){i()}).hide().appendTo(w),T=$("<a/>",{title:"Search for pending Friend Requests you might have missed.",html:"Find pending Friend Requests",id:"ffr-link-find"}).click(function(){c()}).appendTo(w),x={},A=null,F=!1,O=!1}}})();