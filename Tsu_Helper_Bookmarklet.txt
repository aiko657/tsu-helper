javascript:(function(){function e(e){var t,n,s,r,o,i,a,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",u="",l=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");l<e.length;)r=c.indexOf(e.charAt(l++)),o=c.indexOf(e.charAt(l++)),i=c.indexOf(e.charAt(l++)),a=c.indexOf(e.charAt(l++)),t=r<<2|o>>4,n=(15&o)<<4|i>>2,s=(3&i)<<6|a,u+=String.fromCharCode(t),64!=i&&(u+=String.fromCharCode(n)),64!=a&&(u+=String.fromCharCode(s));return u}function t(){$("body.newsfeed").length?(x="home",k=".comment"):$("#profile_feed").length?(x="diary",k=".comment"):document.URL.contains("/post/")?(x="post",k=".comment"):document.URL.endsWith("/followers")?x="followers":document.URL.endsWith("/following")?x="following":(document.URL.contains("/messages/")||document.URL.endsWith("/messages"))&&(x="messages",k=".messages_content .message_box")}function n(e){var t=e.split("#").length-1,n=e.split("@").length-1;if(_>=t&&b>=n)return null;var s="Limits exceeded, check your message! Are you sure you want to continue?\n";return t>_&&(s+="\n"+t+" #hashtags found. (Max. "+_+")"),n>b&&(s+="\n"+n+" @mentions found. (Max. "+b+")"),confirm(s)}function s(e){var t=null,n=null;if(e.find(".checkboxes_options_create_post input:visible").each(function(){switch($(this).attr("id")){case"facebook":t=$(this).prop("checked");break;case"twitter":n=$(this).prop("checked")}}),!1!==t&&!1!==n)return null;var s="OK = Post to Tsu";return!0===t&&(s+=", Facebook"),!0===n&&(s+=", Twitter"),confirm(s+"\nCancel = Choose other social networks")}function r(e,t){var r=e.find("#text").focus().val(),o=e.find("#title").val(),i=""!=e.find("#create_post_pic_preview").text();return""==r&&""==o&&!i||!1===n(r)||!1===s(e)?(t.preventDefault(),e.find(".loading").hide(),setTimeout(function(){e.find("#create_post_button").removeAttr("disabled")},500),!1):void 0}function o(){var e=$(".fancybox-overlay #create_post_form");return e.length?(e.find("#text").focus(),e.submit(function(e){return r($(this),e)}),void(T=!1)):void setTimeout(function(){o()},500)}function i(){$(".post_comment .load_more_post_comment_replies").each(function(){!$(this).hasClass("tsu-helper-nested-reply-parent")&&/\d+/.exec($(this).text())>0&&$(this).addClass("tsu-helper-nested-reply-parent")})}function a(){$("#message_body").focus(),$(".messages_content .message_box").each(function(){if(!$(this).hasClass("tsu-helper-tweaked")){var e=$(this).find(".message-text");e.html(e.html().trim().replace(/(?:\r\n|\r|\n)/g,"<br />")),$(this).addClass("tsu-helper-tweaked")}})}function c(e){switch(e){case"in":K++;break;case"out":M++}F.html('<span class="tsu-helper-card-in">'+K+' received</span>&nbsp;<span class="tsu-helper-card-out">'+M+" sent</span>")}function u(e,t){if(!t||H){var n="/users/profiles/users_list/"+window.current_user.id+"/"+x+"/"+e,s=$.get(n,function(n){var s=$(n).siblings(".card");s.length&&s.each(function(){var e=$(this).find(".friend_button.grey");if(e.length){var t;if(e.hasClass("friend_request_box"))t="in";else{if(!e.attr("href").contains("/cancel/"))return;t="out"}$(".profiles_list .card:not(.tsu-helper-card):first").before($(this).addClass("tsu-helper-card tsu-helper-card-"+t)),c(t)}}),t&&($(n).siblings(".loadmore_profile").length?u(e+1,!0):H=!1)}).always(function(){delete U[e],l()});t?A=s:U[e]=s}}function l(){var e=Object.keys(U).length;H||0!=e||d()}function f(){W=H=!0,K=M=0,c(),F.show(),$(".tsu-helper-card").remove();for(var e=R;e>=1;e--)u(e,e==R);O.hide(),S.show()}function d(){W=H=!1;for(var e in U)U[e].abort(),delete U[e];A.abort(),S.hide(),O.show()}function p(){if(window.current_user.username==$(".profile_details .summary .username").text().trim().substring(1)){var e=$(".profiles_list .title");R=Math.ceil(/\d+/.exec(e.text())/L),S=$("<a/>",{title:"Cancel current search",html:"Cancel",id:"ffr-link-cancel"}).click(function(){d()}).hide().appendTo(e),O=$("<a/>",{title:"Search for all pending Friend Requests.",html:"Find pending Friend Requests",id:"ffr-link-start"}).click(function(){f()}).appendTo(e),F=$("<span/>",{id:"ffr-status-text"}).hide().appendTo(e)}}function h(){if("MutationObserver"in window){var e=document.querySelector(C);if(e){var t=new MutationObserver(function(e){for(var t=!1,n=e.length-1;n>=0;n--){var s=e[n].target.className;if(!s.contains("comment_time_from_now")&&!s.contains("time_to_update")){t=!0;break}}if(t)switch(x){case"home":case"diary":case"post":i();break;case"messages":a()}});t.observe(e,{childList:!0,subtree:!0})}}else $.getScript("https://gist.github.com/raw/2625891/waitForKeyElements.js",function(){switch(x){case"home":case"diary":case"post":waitForKeyElements(k,i);break;case"messages":waitForKeyElements(k,a)}})}function m(){$("<style>").html("#tsu-helper-menuitem-update a:before{display:none !important;}#ffr-link-start,#ffr-link-cancel,#ffr-status-text{float:right;}#ffr-link-cancel{background:url(/assets/loader.gif) no-repeat;padding-left:24px;}#ffr-status-text{margin-right:8px;}#ffr-status-text span{padding:2px 5px;border-radius:3px;}.tsu-helper-card-in{background:#cfc;}.tsu-helper-card-out{background:#eef;}.tsu-helper-nested-reply-parent{text-decoration:underline;color:#777 !important;}").appendTo("head")}function g(){$.getJSON(y,function(t){var n=parseFloat(e(t.content));if(n>w&&($("#navBarHead .tab.name").css("background-color","#F1B054"),0===$("#tsu-helper-menuitem-update").length)){var s=$("<a/>",{title:"Update Tsu Helper script to the newest version ("+n+")",href:v,html:"Update Tsu Helper!"}).attr("target","_blank").css({"background-color":"#F1B054",color:"#fff"}).click(function(){return confirm("Upgrade to the newest version ("+n+")?\n\n(refresh this page after the script has been updated)")?void 0:!1});$("<li/>",{id:"tsu-helper-menuitem-update",html:s}).appendTo("#navBarHead .sub_nav")}})}"function"!=typeof String.prototype.startsWith&&(String.prototype.startsWith=function(e){return this.slice(0,e.length)==e}),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(e){return this.slice(-e.length)==e}),"function"!=typeof String.prototype.contains&&(String.prototype.contains=function(e){return this.indexOf(e)>=0}),m();var _=10,b=10,v="https://greasyfork.org/scripts/6372-tsu-helper/code/Tsu%20Helper.user.js",w=1.3,y="https://api.github.com/repos/noplanman/tsu-helper/contents/VERSION";g(),setTimeout(function(){t(),h()},500),setTimeout(function(){switch(x){case"home":case"diary":case"post":i();break;case"messages":a();break;case"followers":case"following":p()}},1e3);var k,x,C="body";$("#text").focus(),$("body").on("click",".create_post .options .add_title",function(){var e=$(this).closest("#create_post_form").find("#title");e.is(":visible")?setTimeout(function(){$("#text").focus()},50):setTimeout(function(){e.focus()},50)}),$("body").on("click",".create_post .options .filebutton, .cancel_icon_createpost",function(){var e=$(this).closest("#create_post_form").find("#text");setTimeout(function(){e.focus()},50)}),$("#create_post_form").submit(function(e){return r($(this),e)});var T=!1;$(".create_post_popup").click(function(){T||(T=!0,o())}),$("body").on("dblclick",".post_header_name, .share_header",function(e){var t=$(this).closest(".post"),n=t.find(".share_header").length,s=!$(this).hasClass("share_header");t.find("#post_link_dropdown a").each(function(){var t=$(this).text().trim().toLowerCase();if(!n&&"open"===t||!s&&"open"===t||s&&"open original post"===t){var r=$(this).attr("href");return void(e.shiftKey?window.open(r,"_blank").focus():window.location=r)}})});var S,O,F,L=12,R=0,U={},A=null,W=!1,H=!1,K=0,M=0})();